<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Beatnik Encryption</title>
    <link href="https://fonts.googleapis.com/css?family=Gloria+Hallelujah" rel="stylesheet">
    <link rel="stylesheet" href="css/reset.css" type="text/css">
    <link rel="stylesheet" href="css/styles.css" type="text/css">
    <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>-->
    <script src="js/vendor/jquery.js"></script>
    <!--<script src="http://www.club.cc.cmu.edu/~rjmccall/beatnik.js"></script>-->
    <script src="js/vendor/interpreter.js"></script>
    <script src="js/beatnik_encryption.js"></script>
</head>
<body>
<div id="container">
    <h1>Beatnik Encryption</h1>

    <div class="left-of-image">
    <p>The goal of this project was to write a JavaScript function that takes
        a string and outputs a <a href="http://cliffle.com/esoterica/beatnik.html" target="_blank">Beatnik</a>
        program that prints that string.</p>

    <p>To encrypt a file/message/etc for transmission, you can base64 encode
        it, pass it through beatnik_encryption, and send an avante-garde poem
        over the wire! The receiver would then run it through the
        <a href="http://www.club.cc.cmu.edu/~rjmccall/beatnik.js" target="_blank">Beatnik Interpretter</a>,
        base64 decode the resulting string, and <i>presto!</i> -- you're back to the original
        message!</p>
        </div>
    <img src="images/tux-150059_960_720.png" alt="beatniks">
    <div style="clear: both"></div>

    <h2>Encrypting</h2>
    <p>Enter the base64-encoded string you want to encrypt in the textbox below,
        and press <b>Stir my soul!</b></p>

    <form id="encoder-form">
        <label>
            <textarea rows="8" cols="50" name="encoder-text" form="encoder-form"
                      id="encoder-text" placeholder="Enter Text Here..."></textarea>
        </label><br>
        <input type="submit" value="Stir my soul!">
    </form>
    <div id="form_upload_file">
        <h3>Or upload a file to base64 encode and encrypt it.</h3>
        <input type="file" id="encoded_file" name="file" value="Encode File">
    </div>
    <h2>Encryption Results</h2>
    <div id="encoder-results">
        <button class="btn" data-clipboard-target="#encoded-p">
            <img src="/images/clippy.png" alt="Copy to clipboard">
        </button>
        <p id="encoded-p"></p>
    </div>


    <h2>Decryption</h2>
    <p>Enter the Beatnik poem you want to decrypt in the textbox below,
        and press <b>Interpret the tortured genius!</b> Interpreter
        created by the <a href="http://www.club.cc.cmu.edu/" target="_blank">
            Carnegie Mellon Computer Club</a>.</p>

    <form id="decoder-form" autocomplete="off">
        <label>
            <textarea rows="8" cols="50" name="decoder-text" form="decoder-form" id="decoder-text" placeholder="Enter beatnik poem here..." value=""></textarea>
        </label><br>
        <input type="submit" value="Interpret the tortured genius!">
    </form>

    <h2>Decryption Results</h2>
    <p>The results below have been decrypted, but have not yet been base64-decoded.</p>
    <div id="decoder-results">
        <button class="btn" data-clipboard-target="#decoder-results">
            <img src="/images/clippy.png" alt="Copy to clipboard">
        </button>
        <p id="decoded-p"></p>
    </div>

    <div id="download_as_file">
        <button class="submit" id="download_file">Decode and Download As File</button>
    </div>

    <div id="loading-words">LOADING WORDS...</div>

    <footer>
        <h3>Authors:</h3>
        <p>Nathan Karasch (<a href="http://krashdev.com/" target="_blank">krashdev.com</a>)<br></p>
        <p>Charlie Steenhagen (<a href="http://www.stonestreetsoftware.com/"
                               target="_blank">www.stonestreetsoftware.com</a>)</p>
    </footer>

</div>
</body>

<script src="/js/vendor/clipboard.min.js"></script>
<script>
    get_words_api();
    new Clipboard('.btn');

    var handleFileSelect = function(evt) {
        var files = evt.target.files;
        var file = files[0];

        if (files && file) {
            var reader = new FileReader();

            reader.onload = function(readerEvt) {
                var binaryString = readerEvt.target.result;
                encrypted_words = beatnikify(btoa(binaryString));
                $('#encoded-p').html(encrypted_words);
            };

            reader.readAsBinaryString(file);
        }
    };

    if (window.File && window.FileReader && window.FileList && window.Blob) {
        document.getElementById('encoded_file').addEventListener('change', handleFileSelect, false);
    } else {
        alert('The File APIs are not fully supported in this browser.');
    }
</script>
</html>
